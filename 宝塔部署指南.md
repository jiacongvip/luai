# üöÄ ÂÆùÂ°îÈù¢Êùø Docker ÈÉ®ÁΩ≤ÊåáÂçó

Êú¨ÊåáÂçóÂ∞ÜÂ∏ÆÂä©‰Ω†Âú®ÂÆùÂ°îÈù¢Êùø‰∏≠ÈÉ®ÁΩ≤ Nexus Agent Orchestrator Á≥ªÁªü„ÄÇ

## üìã ÂâçÁΩÆË¶ÅÊ±Ç

1. **ÂÆùÂ°îÈù¢Êùø**ÔºàÂ∑≤ÂÆâË£ÖÔºâ
2. **Docker** Âíå **Docker Compose**ÔºàÈúÄË¶ÅÂú®ÂÆùÂ°î‰∏≠ÂÆâË£ÖÔºâ
3. **ÂüüÂêç**ÔºàÂèØÈÄâÔºåÁî®‰∫é HTTPSÔºâ

## üîß Á¨¨‰∏ÄÊ≠•ÔºöÁ°ÆËÆ§ Docker ÁéØÂ¢É

### 1.1 È™åËØÅ Docker

ÂÆùÂ°îÈù¢ÊùøËá™Â∏¶ DockerÔºåÂèØ‰ª•Áõ¥Êé•‰ΩøÁî®„ÄÇ

Âú®ÂÆùÂ°î **ÁªàÁ´Ø** ‰∏≠È™åËØÅÔºö

```bash
# Ê£ÄÊü• Docker
docker --version

# Ê£ÄÊü• Docker Compose
docker-compose --version
```

### 1.2 ÂÆâË£Ö Docker ComposeÔºàÂ¶ÇÊûúÈúÄË¶ÅÔºâ

Â¶ÇÊûú `docker-compose` ÂëΩ‰ª§‰∏çÂ≠òÂú®ÔºåÊâßË°åÔºö

```bash
# ÂÆâË£Ö Docker Compose
curl -L "https://github.com/docker/compose/releases/latest/download/docker-compose-$(uname -s)-$(uname -m)" -o /usr/local/bin/docker-compose
chmod +x /usr/local/bin/docker-compose

# È™åËØÅÂÆâË£Ö
docker-compose --version
```

## üì¶ Á¨¨‰∫åÊ≠•Ôºö‰∏ä‰º†È°πÁõÆÊñá‰ª∂

### 2.1 ÂàõÂª∫È°πÁõÆÁõÆÂΩï

Âú®ÂÆùÂ°î **Êñá‰ª∂ÁÆ°ÁêÜ** ‰∏≠Ôºö

1. ËøõÂÖ• `/www/wwwroot/` ÁõÆÂΩï
2. ÂàõÂª∫Êñ∞Êñá‰ª∂Â§πÔºö`nexus-agent`
3. ‰∏ä‰º†È°πÁõÆÊñá‰ª∂ÔºàÊàñ‰ΩøÁî® Git ÂÖãÈöÜÔºâ

### 2.2 ‰ΩøÁî® Git ÂÖãÈöÜÔºàÊé®ËçêÔºâ

Âú®ÂÆùÂ°î **ÁªàÁ´Ø** ‰∏≠Ôºö

```bash
cd /www/wwwroot/
git clone https://github.com/‰Ω†ÁöÑÁî®Êà∑Âêç/nexus-agent-orchestrator.git nexus-agent
cd nexus-agent
```

## ‚öôÔ∏è Á¨¨‰∏âÊ≠•ÔºöÈÖçÁΩÆÁéØÂ¢ÉÂèòÈáè

### 3.1 ÂàõÂª∫Áîü‰∫ßÁéØÂ¢ÉÈÖçÁΩÆ

Âú®È°πÁõÆÊ†πÁõÆÂΩïÂàõÂª∫ `.env.prod` Êñá‰ª∂Ôºö

```bash
cd /www/wwwroot/nexus-agent
cp .env.prod.example .env.prod
nano .env.prod
```

### 3.2 ÁºñËæëÈÖçÁΩÆ

‰øÆÊîπ‰ª•‰∏ãÂÖ≥ÈîÆÈÖçÁΩÆÔºö

```env
# Êï∞ÊçÆÂ∫ìÈÖçÁΩÆÔºà‰ΩøÁî®Âº∫ÂØÜÁ†ÅÔºÅÔºâ
POSTGRES_USER=nexus_user
POSTGRES_PASSWORD=‰Ω†ÁöÑÂº∫ÂØÜÁ†Å_Ëá≥Â∞ë16‰Ωç
POSTGRES_DB=nexus_db
POSTGRES_PORT=5432

# ÂêéÁ´ØÈÖçÁΩÆ
BACKEND_PORT=3001
JWT_SECRET=ÁîüÊàê‰∏Ä‰∏™Ëá≥Â∞ë32‰ΩçÁöÑÈöèÊú∫Â≠óÁ¨¶‰∏≤
JWT_EXPIRES_IN=7d
GEMINI_API_KEY=‰Ω†ÁöÑGemini APIÂØÜÈí•

# ÂâçÁ´ØÈÖçÁΩÆ
FRONTEND_PORT=80
VITE_API_URL=http://‰Ω†ÁöÑÂüüÂêç/api
CORS_ORIGIN=http://‰Ω†ÁöÑÂüüÂêç
```

**ÁîüÊàê JWT_SECRET**Ôºö
```bash
openssl rand -base64 32
```

## üê≥ Á¨¨ÂõõÊ≠•ÔºöÊûÑÂª∫ÂíåÂêØÂä® Docker ÂÆπÂô®

### 4.1 ÊûÑÂª∫ÈïúÂÉè

Âú®ÂÆùÂ°î **ÁªàÁ´Ø** ‰∏≠Ôºö

```bash
cd /www/wwwroot/nexus-agent

# ÊûÑÂª∫ÊâÄÊúâÊúçÂä°
docker-compose -f docker-compose.prod.yml --env-file .env.prod build
```

### 4.2 ÂêØÂä®ÊúçÂä°

```bash
# ÂêØÂä®ÊâÄÊúâÊúçÂä°ÔºàÂêéÂè∞ËøêË°åÔºâ
docker-compose -f docker-compose.prod.yml --env-file .env.prod up -d
```

### 4.3 Êü•ÁúãÊó•Âøó

```bash
# Êü•ÁúãÊâÄÊúâÊúçÂä°Êó•Âøó
docker-compose -f docker-compose.prod.yml logs -f

# Âè™ÁúãÂêéÁ´ØÊó•Âøó
docker-compose -f docker-compose.prod.yml logs -f backend

# Âè™ÁúãÂâçÁ´ØÊó•Âøó
docker-compose -f docker-compose.prod.yml logs -f frontend
```

## üóÑÔ∏è Á¨¨‰∫îÊ≠•ÔºöÂàùÂßãÂåñÊï∞ÊçÆÂ∫ì

### 5.1 ËøêË°åÊï∞ÊçÆÂ∫ìËøÅÁßª

```bash
# ËøõÂÖ•ÂêéÁ´ØÂÆπÂô®
docker-compose -f docker-compose.prod.yml exec backend sh

# Âú®ÂÆπÂô®ÂÜÖËøêË°åËøÅÁßª
npm run migrate

# ÈÄÄÂá∫ÂÆπÂô®
exit
```

ÊàñËÄÖÁõ¥Êé•ÊâßË°åÔºö

```bash
docker-compose -f docker-compose.prod.yml exec backend npm run migrate
```

## üåê Á¨¨ÂÖ≠Ê≠•ÔºöÈÖçÁΩÆÂÆùÂ°îÂèçÂêë‰ª£ÁêÜÔºàÊé®ËçêÔºâ

### 6.1 ÂàõÂª∫ÁΩëÁ´ô

1. ËøõÂÖ•ÂÆùÂ°î **ÁΩëÁ´ô** ‚Üí **Ê∑ªÂä†Á´ôÁÇπ**
2. ËæìÂÖ•‰Ω†ÁöÑÂüüÂêçÔºàÂ¶ÇÔºö`nexus.yourdomain.com`Ôºâ
3. ÈÄâÊã© **Á∫ØÈùôÊÄÅ** Êàñ **PHP È°πÁõÆ**Ôºà‰∏çÈáçË¶ÅÔºåÊàë‰ª¨Âè™Áî®ÂèçÂêë‰ª£ÁêÜÔºâ

### 6.2 ÈÖçÁΩÆÂèçÂêë‰ª£ÁêÜ

1. ÁÇπÂáªÁΩëÁ´ôÂè≥‰æß **ËÆæÁΩÆ**
2. ËøõÂÖ• **ÂèçÂêë‰ª£ÁêÜ** Ê†áÁ≠æ
3. ÁÇπÂáª **Ê∑ªÂä†ÂèçÂêë‰ª£ÁêÜ**
4. ÈÖçÁΩÆÂ¶Ç‰∏ãÔºö

```
‰ª£ÁêÜÂêçÁß∞Ôºönexus-frontend
ÁõÆÊ†áURLÔºöhttp://127.0.0.1:80
ÂèëÈÄÅÂüüÂêçÔºö$host
```

5. ÁÇπÂáª **‰øùÂ≠ò**

### 6.3 ÈÖçÁΩÆ SSL ËØÅ‰π¶ÔºàHTTPSÔºâ

1. Âú®ÁΩëÁ´ôËÆæÁΩÆ‰∏≠ËøõÂÖ• **SSL** Ê†áÁ≠æ
2. ÈÄâÊã© **Let's Encrypt** ÂÖçË¥πËØÅ‰π¶
3. ÁÇπÂáª **Áî≥ËØ∑**
4. ÂºÄÂêØ **Âº∫Âà∂ HTTPS**

## üîç Á¨¨‰∏ÉÊ≠•ÔºöÈ™åËØÅÈÉ®ÁΩ≤

### 7.1 Ê£ÄÊü•ÊúçÂä°Áä∂ÊÄÅ

```bash
docker-compose -f docker-compose.prod.yml ps
```

Â∫îËØ•ÁúãÂà∞‰∏â‰∏™ÊúçÂä°ÈÉΩÂú®ËøêË°åÔºö
- `nexus-postgres-prod` (Êï∞ÊçÆÂ∫ì)
- `nexus-backend-prod` (ÂêéÁ´Ø)
- `nexus-frontend-prod` (ÂâçÁ´Ø)

### 7.2 ÊµãËØïËÆøÈóÆ

1. **ÂâçÁ´Ø**ÔºöËÆøÈóÆ `http://‰Ω†ÁöÑÂüüÂêç`
2. **ÂêéÁ´ØÂÅ•Â∫∑Ê£ÄÊü•**ÔºöËÆøÈóÆ `http://‰Ω†ÁöÑÂüüÂêç/api/health`
3. **Êï∞ÊçÆÂ∫ì**ÔºöÊ£ÄÊü•ÂÆπÂô®Êó•ÂøóÁ°ÆËÆ§ËøûÊé•Ê≠£Â∏∏

## üìä Á¨¨ÂÖ´Ê≠•ÔºöÂÆùÂ°îÈù¢ÊùøÁÆ°ÁêÜ

### 8.1 Êü•ÁúãÂÆπÂô®Áä∂ÊÄÅ

Âú®ÂÆùÂ°î **Docker** ÁÆ°ÁêÜÁïåÈù¢Ôºö
- ÂèØ‰ª•ÁúãÂà∞ÊâÄÊúâËøêË°åÁöÑÂÆπÂô®
- ÂèØ‰ª•Êü•ÁúãÊó•Âøó„ÄÅÈáçÂêØ„ÄÅÂÅúÊ≠¢ÂÆπÂô®

### 8.2 ËÆæÁΩÆËá™Âä®ÂêØÂä®

Docker Compose ÈÖçÁΩÆ‰∏≠Â∑≤ËÆæÁΩÆ `restart: unless-stopped`ÔºåÂÆπÂô®‰ºöËá™Âä®ÈáçÂêØ„ÄÇ

### 8.3 ÁõëÊéßËµÑÊ∫ê‰ΩøÁî®

Âú®ÂÆùÂ°î **ÁõëÊéß** ‰∏≠Êü•ÁúãÔºö
- CPU ‰ΩøÁî®Áéá
- ÂÜÖÂ≠ò‰ΩøÁî®Áéá
- Á£ÅÁõò‰ΩøÁî®Áéá

## üîÑ Â∏∏Áî®ÁÆ°ÁêÜÂëΩ‰ª§

### ÈáçÂêØÊúçÂä°

```bash
cd /www/wwwroot/nexus-agent
docker-compose -f docker-compose.prod.yml restart
```

### ÂÅúÊ≠¢ÊúçÂä°

```bash
docker-compose -f docker-compose.prod.yml stop
```

### ÂêØÂä®ÊúçÂä°

```bash
docker-compose -f docker-compose.prod.yml start
```

### Êü•ÁúãÊó•Âøó

```bash
# ÊâÄÊúâÊúçÂä°
docker-compose -f docker-compose.prod.yml logs -f

# ÁâπÂÆöÊúçÂä°
docker-compose -f docker-compose.prod.yml logs -f backend
docker-compose -f docker-compose.prod.yml logs -f frontend
docker-compose -f docker-compose.prod.yml logs -f postgres
```

### Êõ¥Êñ∞‰ª£Á†Å

```bash
cd /www/wwwroot/nexus-agent

# ÊãâÂèñÊúÄÊñ∞‰ª£Á†Å
git pull

# ÈáçÊñ∞ÊûÑÂª∫Âπ∂ÂêØÂä®
docker-compose -f docker-compose.prod.yml --env-file .env.prod up -d --build
```

### Â§á‰ªΩÊï∞ÊçÆÂ∫ì

```bash
# ÂàõÂª∫Â§á‰ªΩ
docker-compose -f docker-compose.prod.yml exec postgres pg_dump -U nexus_user nexus_db > backup_$(date +%Y%m%d_%H%M%S).sql

# ÊÅ¢Â§çÂ§á‰ªΩ
docker-compose -f docker-compose.prod.yml exec -T postgres psql -U nexus_user nexus_db < backup.sql
```

## üõ°Ô∏è ÂÆâÂÖ®Âª∫ËÆÆ

### 1. ‰øÆÊîπÈªòËÆ§Á´ØÂè£

Â¶ÇÊûúÁõ¥Êé•Êö¥Èú≤Á´ØÂè£ÔºåÂª∫ËÆÆ‰øÆÊîπÔºö

```env
POSTGRES_PORT=5433  # Êîπ‰∏∫ÈùûÊ†áÂáÜÁ´ØÂè£
BACKEND_PORT=3002   # Êîπ‰∏∫ÈùûÊ†áÂáÜÁ´ØÂè£
```

### 2. ‰ΩøÁî®Èò≤ÁÅ´Â¢ô

Âú®ÂÆùÂ°î **ÂÆâÂÖ®** ‰∏≠Ôºö
- Âè™ÂºÄÊîæÂøÖË¶ÅÁ´ØÂè£Ôºà80, 443Ôºâ
- ÂÖ≥Èó≠‰∏çÂøÖË¶ÅÁöÑÁ´ØÂè£

### 3. ÂÆöÊúüÂ§á‰ªΩ

ËÆæÁΩÆÂÆùÂ°î **ËÆ°Âàí‰ªªÂä°**Ôºö
- ÊØèÂ§©Â§á‰ªΩÊï∞ÊçÆÂ∫ì
- ÊØèÂë®Â§á‰ªΩÈ°πÁõÆÊñá‰ª∂

### 4. ÁõëÊéßÊó•Âøó

ÂÆöÊúüÊü•ÁúãÊó•ÂøóÔºåÂèëÁé∞ÂºÇÂ∏∏Ôºö
```bash
docker-compose -f docker-compose.prod.yml logs --tail=100
```

## üêõ ÊïÖÈöúÊéíÈô§

### ÈóÆÈ¢ò1ÔºöÂÆπÂô®Êó†Ê≥ïÂêØÂä®

**Ê£ÄÊü•Êó•Âøó**Ôºö
```bash
docker-compose -f docker-compose.prod.yml logs
```

**Â∏∏ËßÅÂéüÂõ†**Ôºö
- Á´ØÂè£Ë¢´Âç†Áî®
- ÁéØÂ¢ÉÂèòÈáèÈÖçÁΩÆÈîôËØØ
- Êï∞ÊçÆÂ∫ìËøûÊé•Â§±Ë¥•

### ÈóÆÈ¢ò2ÔºöÂâçÁ´ØÊó†Ê≥ïËÆøÈóÆÂêéÁ´Ø

**Ê£ÄÊü•**Ôºö
1. ÂêéÁ´ØÊòØÂê¶Ê≠£Â∏∏ËøêË°åÔºö`docker-compose ps`
2. ÂêéÁ´ØÊó•ÂøóÔºö`docker-compose logs backend`
3. Nginx ÈÖçÁΩÆÊòØÂê¶Ê≠£Á°Æ

### ÈóÆÈ¢ò3ÔºöÊï∞ÊçÆÂ∫ìËøûÊé•Â§±Ë¥•

**Ê£ÄÊü•**Ôºö
1. Êï∞ÊçÆÂ∫ìÂÆπÂô®ÊòØÂê¶ÂÅ•Â∫∑Ôºö`docker-compose ps`
2. ÁéØÂ¢ÉÂèòÈáè `DATABASE_URL` ÊòØÂê¶Ê≠£Á°Æ
3. Êï∞ÊçÆÂ∫ìÂØÜÁ†ÅÊòØÂê¶Ê≠£Á°Æ

### ÈóÆÈ¢ò4Ôºö502 Bad Gateway

**ÂèØËÉΩÂéüÂõ†**Ôºö
- ÂêéÁ´ØÊúçÂä°Êú™ÂêØÂä®
- Á´ØÂè£ÈÖçÁΩÆÈîôËØØ
- Nginx ÈÖçÁΩÆÈîôËØØ

**Ëß£ÂÜ≥**Ôºö
```bash
# Ê£ÄÊü•ÂêéÁ´ØÁä∂ÊÄÅ
docker-compose -f docker-compose.prod.yml ps backend

# ÈáçÂêØÂêéÁ´Ø
docker-compose -f docker-compose.prod.yml restart backend
```

## üìù Ê≥®ÊÑè‰∫ãÈ°π

1. **È¶ñÊ¨°ÈÉ®ÁΩ≤**ÔºöÊï∞ÊçÆÂ∫ìÂàùÂßãÂåñÈúÄË¶ÅÂá†ÂàÜÈíü
2. **ÂÜÖÂ≠òË¶ÅÊ±Ç**ÔºöÂª∫ËÆÆËá≥Â∞ë 2GB ÂèØÁî®ÂÜÖÂ≠ò
3. **Á£ÅÁõòÁ©∫Èó¥**ÔºöÂª∫ËÆÆËá≥Â∞ë 10GB ÂèØÁî®Á©∫Èó¥
4. **ÂÆöÊúüÊõ¥Êñ∞**ÔºöÂÆöÊúüÊõ¥Êñ∞ Docker ÈïúÂÉèÂíå‰ª£Á†Å

## üéâ ÂÆåÊàêÔºÅ

ÈÉ®ÁΩ≤ÂÆåÊàêÂêéÔºå‰Ω†ÂèØ‰ª•Ôºö
- ËÆøÈóÆÂâçÁ´ØÔºö`http://‰Ω†ÁöÑÂüüÂêç`
- ËÆøÈóÆÂêéÁ´Ø APIÔºö`http://‰Ω†ÁöÑÂüüÂêç/api`
- Âú®ÂÆùÂ°îÈù¢Êùø‰∏≠ÁÆ°ÁêÜÊâÄÊúâÊúçÂä°

Â¶ÇÊúâÈóÆÈ¢òÔºåËØ∑Êü•ÁúãÊó•ÂøóÊàñËÅîÁ≥ªÊäÄÊúØÊîØÊåÅ„ÄÇ

