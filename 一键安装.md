# 🚀 一键安装指南

## 方式一：宝塔终端一键安装（推荐）

### 1. 打开宝塔终端

登录宝塔面板 → **终端** → 新建终端

### 2. 执行一键安装命令

```bash
# 下载并运行安装脚本
curl -fsSL https://raw.githubusercontent.com/你的用户名/nexus-agent-orchestrator/main/install.sh | bash
```

或者如果脚本在服务器上：

```bash
# 上传 install.sh 到服务器后
chmod +x install.sh
./install.sh
```

### 3. 按提示操作

安装脚本会：
- ✅ 自动检测 Docker 环境
- ✅ 自动安装 Docker Compose（如果需要）
- ✅ 询问是否使用 Git 克隆项目
- ✅ 自动生成安全密码和密钥
- ✅ 询问域名和 API 密钥
- ✅ 自动构建和启动服务
- ✅ 自动运行数据库迁移

### 4. 配置宝塔反向代理

安装完成后，在宝塔中：
1. **网站** → **添加站点**
2. 输入你的域名
3. **设置** → **反向代理** → **添加**
   - 目标URL: `http://127.0.0.1:80`
   - 发送域名: `$host`
4. **SSL** → 申请证书 → 开启强制HTTPS

## 方式二：宝塔应用商店一键部署（需要打包）

如果你想做成宝塔应用商店的应用，需要：

### 1. 创建应用包

```bash
# 打包项目
tar -czf nexus-agent.tar.gz \
  --exclude='node_modules' \
  --exclude='.git' \
  --exclude='dist' \
  .
```

### 2. 创建 install.json（宝塔应用配置）

```json
{
  "name": "Nexus Agent Orchestrator",
  "version": "1.0.0",
  "description": "AI智能体编排系统",
  "author": "Your Name",
  "install_script": "install.sh",
  "uninstall_script": "uninstall.sh"
}
```

### 3. 上传到宝塔应用商店

需要提交到宝塔官方审核。

## 方式三：手动一键安装

### 1. 上传项目文件

在宝塔 **文件管理** 中上传项目到 `/www/wwwroot/nexus-agent`

### 2. 运行安装脚本

在宝塔 **终端** 中：

```bash
cd /www/wwwroot/nexus-agent
chmod +x install.sh
./install.sh
```

### 3. 按提示输入信息

- 是否使用 Git：`n`（如果已上传文件）
- 域名：输入你的域名
- API 密钥：输入 Gemini API 密钥（可选）

### 4. 等待安装完成

脚本会自动完成所有配置和部署。

## 📋 安装脚本功能

✅ **自动检测环境**
- 检查 Docker 是否安装
- 检查 Docker Compose 是否安装
- 自动安装缺失组件

✅ **自动配置**
- 生成随机数据库密码
- 生成 JWT 密钥
- 配置域名和 API 密钥

✅ **自动部署**
- 构建 Docker 镜像
- 启动所有服务
- 运行数据库迁移

✅ **状态检查**
- 显示服务运行状态
- 提供常用命令

## 🔧 安装后配置

### 1. 配置反向代理

在宝塔网站设置中：
- 代理名称：`nexus`
- 目标URL：`http://127.0.0.1:80`
- 发送域名：`$host`

### 2. 配置 SSL

- 申请 Let's Encrypt 证书
- 开启强制 HTTPS

### 3. 访问系统

访问你的域名，开始使用！

## 🐛 常见问题

### 安装失败

```bash
# 查看详细日志
docker-compose -f docker-compose.prod.yml logs

# 重新安装
./install.sh
```

### 端口被占用

修改 `.env.prod` 中的端口配置，或停止占用端口的服务。

### 数据库连接失败

检查 `.env.prod` 中的数据库配置是否正确。

## 📝 卸载

```bash
cd /www/wwwroot/nexus-agent
docker-compose -f docker-compose.prod.yml down -v
rm -rf /www/wwwroot/nexus-agent
```

## ✅ 完成！

安装完成后，系统会自动运行，你可以：
- 访问前端界面
- 使用所有功能
- 在宝塔中管理服务

