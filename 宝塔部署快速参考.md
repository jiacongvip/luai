# ğŸš€ å®å¡” Docker éƒ¨ç½²å¿«é€Ÿå‚è€ƒ

## âš¡ å¿«é€Ÿå¼€å§‹ï¼ˆ5åˆ†é’Ÿï¼‰

```bash
# 1. è¿›å…¥é¡¹ç›®ç›®å½•
cd /www/wwwroot/nexus-agent

# 2. é…ç½®ç¯å¢ƒå˜é‡
cp env.prod.example .env.prod
nano .env.prod  # ä¿®æ”¹å¿…è¦çš„é…ç½®

# 3. ä¸€é”®å®‰è£…
chmod +x install.sh
./install.sh

# 4. åœ¨å®å¡”ä¸­é…ç½®åå‘ä»£ç†
# ç½‘ç«™ â†’ è®¾ç½® â†’ åå‘ä»£ç† â†’ æ·»åŠ 
# ç›®æ ‡URL: http://127.0.0.1:80
```

## ğŸ“‹ å¿…é¡»é…ç½®çš„ç¯å¢ƒå˜é‡

```env
# æ•°æ®åº“å¯†ç ï¼ˆå¿…é¡»ä¿®æ”¹ï¼ï¼‰
POSTGRES_PASSWORD=ä½ çš„å¼ºå¯†ç 

# JWTå¯†é’¥ï¼ˆå¿…é¡»ä¿®æ”¹ï¼ï¼‰
JWT_SECRET=ç”Ÿæˆ32ä½éšæœºå­—ç¬¦ä¸²

# Gemini APIå¯†é’¥ï¼ˆå¿…é¡»é…ç½®ï¼‰
GEMINI_API_KEY=ä½ çš„APIå¯†é’¥

# åŸŸåé…ç½®ï¼ˆå¦‚æœæœ‰åŸŸåï¼‰
VITE_API_URL=http://ä½ çš„åŸŸå/api
CORS_ORIGIN=http://ä½ çš„åŸŸå
```

## ğŸ”§ å®å¡”åå‘ä»£ç†é…ç½®

### å‰ç«¯ä»£ç†
```
ä»£ç†åç§°ï¼šnexus-frontend
ç›®æ ‡URLï¼šhttp://127.0.0.1:80
å‘é€åŸŸåï¼š$host
```

### API ä»£ç†ï¼ˆå¯é€‰ï¼Œå¦‚æœå‰ç«¯å®¹å™¨å·²é…ç½®åˆ™ä¸éœ€è¦ï¼‰
```
ä»£ç†åç§°ï¼šnexus-api
ç›®æ ‡URLï¼šhttp://127.0.0.1:3001
ä½ç½®ï¼š/api
```

## ğŸ“ å¸¸ç”¨å‘½ä»¤

### æŸ¥çœ‹çŠ¶æ€
```bash
cd /www/wwwroot/nexus-agent
docker-compose -f docker-compose.prod.yml ps
```

### æŸ¥çœ‹æ—¥å¿—
```bash
# æ‰€æœ‰æœåŠ¡
docker-compose -f docker-compose.prod.yml logs -f

# ç‰¹å®šæœåŠ¡
docker-compose -f docker-compose.prod.yml logs -f backend
```

### é‡å¯æœåŠ¡
```bash
docker-compose -f docker-compose.prod.yml restart
```

### æ›´æ–°ä»£ç 
```bash
git pull
docker-compose -f docker-compose.prod.yml --env-file .env.prod up -d --build
```

### å¤‡ä»½æ•°æ®åº“
```bash
docker-compose -f docker-compose.prod.yml exec -T postgres pg_dump -U nexus_user nexus_db > backup_$(date +%Y%m%d).sql
```

## ğŸ› å¸¸è§é—®é¢˜

### 502 é”™è¯¯
```bash
# æ£€æŸ¥åç«¯
docker-compose -f docker-compose.prod.yml ps backend
docker-compose -f docker-compose.prod.yml restart backend
```

### ç«¯å£è¢«å ç”¨
```bash
# æ£€æŸ¥ç«¯å£
netstat -tlnp | grep -E ':(80|3001)'

# ä¿®æ”¹ .env.prod ä¸­çš„ç«¯å£å·
```

### æ•°æ®åº“è¿æ¥å¤±è´¥
```bash
# æ£€æŸ¥æ•°æ®åº“
docker-compose -f docker-compose.prod.yml ps postgres
docker-compose -f docker-compose.prod.yml logs postgres
```

## ğŸ” ç”Ÿæˆå®‰å…¨å¯†é’¥

```bash
# æ•°æ®åº“å¯†ç 
openssl rand -base64 24 | tr -d "=+/" | cut -c1-24

# JWTå¯†é’¥
openssl rand -base64 32
```

## ğŸ“ å®Œæ•´æ–‡æ¡£

è¯¦ç»†éƒ¨ç½²æŒ‡å—è¯·æŸ¥çœ‹ï¼š`å®å¡”Dockeréƒ¨ç½²å®Œæ•´æŒ‡å—.md`










